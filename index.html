<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generator Link Preview</title>
    <style>
        body { font-family: -apple-system, sans-serif; background: #0f172a; color: white; display: flex; justify-content: center; padding: 50px 20px; }
        .card { background: #1e293b; padding: 30px; border-radius: 16px; width: 100%; max-width: 450px; box-shadow: 0 10px 25px rgba(0,0,0,0.3); }
        h2 { margin-top: 0; color: #38bdf8; }
        input { width: 100%; padding: 12px; margin: 15px 0; border: 1px solid #334155; border-radius: 8px; background: #0f172a; color: white; box-sizing: border-box; }
        button { width: 100%; padding: 14px; background: #0284c7; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; }
        #result { margin-top: 25px; padding: 15px; background: #334155; border-radius: 8px; display: none; word-break: break-all; border: 1px dashed #38bdf8; }
        .copy-btn { background: #10b981; margin-top: 10px; padding: 8px; border: none; color: white; border-radius: 5px; cursor: pointer; width: 100%; }
    </style>
</head>
<body>
    <div class="card">
        <h2>Link Generator</h2>
        <p style="font-size: 0.8em; color: #94a3b8;">Masukkan link tujuan akhir di bawah ini:</p>
        <input type="text" id="target" placeholder="https://tujuan-anda.com">
        <button onclick="generate()">Generate & Salin Link</button>
        
        <div id="result">
            <span style="font-size: 0.8em; color: #38bdf8;">Link Siap Pakai:</span><br>
            <p id="finalLink" style="font-family: monospace; font-size: 0.9em;"></p>
            <button class="copy-btn" onclick="copy()">Salin ke Clipboard</button>
        </div>
    </div>

    <script>
        async function generate() {
            const target = document.getElementById('target').value;
            if(!target) return alert("Masukkan URL!");
            const btn = document.querySelector('button');
            btn.innerText = "Mengambil Domain...";

            try {
                // Mengambil domain acak dari script share.js di pages dev ini
                const res = await fetch('/share?get_random=true');
                const data = await res.json();
                
                // Membuat link akhir yang mengarah ke /share
                const final = `https://${data.domain}/share?url=${encodeURIComponent(target)}`;
                
                document.getElementById('finalLink').innerText = final;
                document.getElementById('result').style.display = 'block';
                btn.innerText = "Berhasil!";
                setTimeout(() => btn.innerText = "Generate & Salin Link", 2000);
            } catch (e) {
                alert("Gagal mengambil domain acak.");
                btn.innerText = "Generate & Salin Link";
            }
        }

        function copy() {
            const text = document.getElementById('finalLink').innerText;
            navigator.clipboard.writeText(text);
            alert("Tersalin!");
        }
    </script>
</body>
</html>
